<?
require('../lib/segurancas.php');

//Busco toda a Lista de Preo da Linha de Machos da Intertaps, porque esses sero Migrados p/ o Fornecedor Winner ...
$sql = "SELECT * 
        FROM `fornecedores_x_prod_insumos` 
        WHERE `id_fornecedor` = '657' 
        AND `id_produto_insumo` IN (1950, 7730, 1951, 1952, 1953, 1954, 1955, 5888, 5995, 5767, 6023, 5867, 5990, 6004, 6018, 5986, 6000, 6014, 5982, 5859, 5863, 5984, 5993, 6007, 6021, 5988, 6002, 6016, 5987, 6001, 6015, 5983, 5992, 6006, 6020, 5989, 6003, 6017, 5985, 5994, 6008, 6022, 5991, 6005, 6019, 5857, 1995, 1996, 1997, 1998, 1999, 2000, 5882, 5883, 5787, 5789, 6024, 6025, 6026, 5784, 6027, 6028, 6029, 6030, 4774, 5785, 6031, 6032, 6033, 6034, 6035, 6036, 6037, 6038, 5814, 6041, 6042, 5816, 6043, 6044, 6045, 5796, 6046, 6047, 5818, 5820, 6048, 6049, 5822, 5824, 6050, 5826, 5828, 6051, 5830, 5832, 6052, 5834, 6053, 5836, 5798, 4694, 5801, 5804, 5806, 6039, 5808, 5810, 6040, 5812, 5998, 6012, 5999, 6013, 5996, 6009, 5380, 6010, 5997, 6011, 2001, 2002, 2003, 7648, 5878, 5854, 4162, 5866, 5870, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 5858, 5860, 5862, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024, 2025, 2026, 2027, 2028, 2029, 2030, 2031, 2032, 2033, 2034, 5856, 5786, 5788, 2044, 2043, 2045, 3814, 2046, 2047, 2048, 2049, 8224, 4372, 2035, 4339, 5442, 2036, 2037, 2038, 2039, 2040, 2041, 2042, 5794, 5813, 2050, 2051, 5815, 2052, 2053, 2054, 3822, 2055, 2056, 6843, 5817, 7943, 5819, 2057, 7731, 2058, 7944, 5821, 5823, 2059, 5825, 5827, 2060, 5829, 5831, 2061, 5833, 2062, 5835, 5837, 5841, 5843, 5797, 5799, 5800, 5803, 5805, 2063, 5807, 5809, 2064, 5811, 2071, 1941, 1942, 1943, 2065, 2066, 2067, 2068, 2069, 2070, 3840, 11002, 10575, 10515, 8171, 8177, 4576, 6723, 6724, 3861, 10516, 6725, 9298, 6726, 9023, 9303, 10817, 9299, 11003, 7902, 9300, 9301, 6728, 6729, 6731, 7184, 6732, 8135, 6733, 8136, 6735, 7182, 8426, 6727, 9804, 8172, 7183, 9132, 8137, 8138, 6730, 11312, 6734, 5718, 9565, 9566, 9807, 9568, 9567, 10796, 12141, 12133, 6086, 9805, 8173, 3527, 8616, 12125, 3528, 5484, 12140, 3530, 3531, 9581, 6080, 4207, 12124, 9583, 12131, 6085, 9582, 12129, 12123, 9806, 12132, 12130, 3532, 3533, 3534, 8617, 12134, 9584, 12135, 12136, 6081, 6082, 3535, 3536, 3537, 5485, 3538, 3539, 3540, 3541, 6083, 3529, 3542, 3543, 11313, 3544, 8097, 12137, 11311, 12138, 12139, 12250, 3545, 12128, 6084, 12126, 12127, 6584, 7065, 6585, 4830, 7064, 2575, 2576, 2604, 7066, 7502, 2605, 2606, 9187, 2607, 7510, 2577, 2608, 7067, 7068, 7069, 7070, 7511, 2573, 7071, 7072, 2578, 2574, 7073, 2579, 12058, 6583, 7512, 2580, 12059, 7513, 7514, 12065, 7075, 7076, 2595, 2597, 7515, 7516, 7517, 2603, 4232, 2581, 4752, 2583, 2584, 7074, 6091, 2587, 7077, 2589, 2590, 2591, 5674, 2593, 2594, 4831, 5235, 7780, 2596, 2598, 4832, 2599, 4775, 2600, 4776, 2601, 4777, 2953, 4660, 12066, 2585, 7078, 12063, 12064, 7079, 12060, 12061, 7080, 12062, 3839, 1944, 7807, 1945, 1946, 1947, 1948, 1949, 4252, 4253, 1882, 4254, 4255, 1885, 4250, 4251, 1888, 4256, 5926, 5927, 4257, 4258, 4259, 1893, 4260, 4261, 1896, 4262, 4263, 1899, 4264, 4265, 4266, 1903, 4267, 4268, 1906, 4269, 4270, 4271, 1907, 4272, 4273, 1908, 5928, 1909, 1910, 1911, 1912, 1913, 1914, 3793, 3794, 5779, 5934, 4282, 4281, 4283, 5935, 4284, 4285, 4286, 4287, 5669, 4274, 4275, 4276, 4277, 5909, 4278, 4279, 4280, 5944, 1915, 1916, 3849, 1917, 1918, 1919, 1920, 1921, 1922, 5945, 5946, 4024, 1923, 1924, 5947, 6669, 1925, 5948, 5949, 1926, 5950, 5951, 1927, 5952, 5953, 1928, 5195, 5938, 5939, 4910, 6668, 4911, 4915, 6671, 5940, 1929, 5941, 5942, 4919, 1930, 5943, 4290, 1934, 4291, 1935, 4288, 1931, 5381, 1932, 4289, 1933, 1936, 1937, 5291, 1938, 1939, 1940, 1956, 1957, 5973, 5974, 1958, 1959, 1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970, 1971, 1972, 1973, 1974, 5969, 5970, 5190, 1993, 1992, 1994, 5971, 1976, 1977, 1978, 1979, 5975, 1975, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 4022, 1983, 1984, 1980, 1981, 1982, 4396, 4402, 6327, 4398, 4404, 6328, 4397, 4403, 6329, 6331, 4395, 4401, 6332, 6333, 6334, 6335, 4042, 6336, 6337, 6338, 6339, 6340, 6341, 6342, 6392, 6393, 6394, 6396, 6397, 6399, 6400, 6402, 6403, 6405, 6406, 3911, 3917, 3923, 3907, 3913, 3919, 6407, 6408, 5419, 6409, 6410, 3909, 3915, 3921, 3908, 3914, 3920, 6411, 6412, 6413, 3910, 3916, 3922, 6414, 6415, 6416, 6417, 6418, 6419, 6420, 3906, 3912, 3918, 6421, 6422, 6423, 6424, 6425, 6426, 6427, 6428, 6429, 6430, 6431, 6481, 6482, 4302, 6483, 6484, 6485, 4432, 4301, 4862, 4434, 4435, 4436, 7274, 7275, 7276, 7277, 7278, 7279, 7280, 7281, 7282, 7283, 6248, 6249, 6238, 3929, 6241, 3935, 6242, 6250, 3931, 3930, 6251, 6252, 3932, 3933, 6253, 3934, 3998, 3936, 6254, 6255, 6243, 6256, 6257, 6258, 6244, 6259, 4318, 6260, 6261, 6239, 6245, 6262, 6263, 6237, 6264, 6265, 6266, 6267, 6502, 6503, 6504, 6505, 6506, 6507, 3924, 3925, 6508, 3926, 3927, 3928, 6509, 6510, 6511, 6512, 6513, 6514, 11033, 8167, 6722, 11031, 11015, 11029, 11010, 11233, 8166, 11032, 11030, 11012, 11014, 11017, 11011, 12309, 11016, 11013, 11018, 11034, 8169, 11023, 11024, 11025, 11026, 11019, 11020, 11021, 11022, 11027, 8170, 8425, 11028, 8174, 8175, 9302, 8176, 9569, 9570, 9571, 11036, 12210, 12209, 6736, 6842, 6737, 6738, 6739, 12206, 11038, 6740, 11039, 12207, 6741, 6742, 6743, 7443, 6744, 6745, 7644, 6746, 11041, 6747, 7089, 7901, 11040, 12208, 11035, 6748, 6753, 6754, 6895, 6755, 6756, 6757, 6758, 6749, 11042, 6759, 6750, 6751, 7090, 12212, 6752, 7645, 6760, 12213, 7646, 3863, 12215, 6761, 6762, 12214, 3864, 6763, 12211, 6764, 6765, 12204, 9585, 12205, 6087, 12201, 11037, 12202, 6766, 6767, 12203, 12318, 10537, 10538, 3832, 7799, 7013, 12073, 6882, 7014, 7015, 10790, 6890, 7016, 7017, 6866, 6883, 6884, 7018, 8064, 10539, 6885, 3894, 7019, 6864, 2572, 7020, 6865, 6099, 8066, 7021, 7022, 10540, 7778, 3321, 8168, 7788, 7789, 12067, 7790, 3796, 3320, 2588, 6098, 7032, 7033, 12074, 7113, 7793, 7794, 6094, 7795, 6095, 6096, 4222, 7798, 7023, 6097, 10542, 7024, 7025, 7027, 7028, 7029, 5671, 7030, 7031, 7792, 6773, 7791, 7034, 3884, 7035, 7036, 3886, 5429, 3887, 7796, 7797, 7037, 7583, 12071, 7038, 12072, 7039, 12068, 7040, 12069, 7041, 12070, 10541, 4363, 4413, 6312, 4409, 4415, 6313, 4408, 4414, 6314, 6316, 4407, 4412, 6317, 6318, 6319, 6320, 5487, 6321, 6322, 6323, 6324, 5488, 4553, 6325, 4292, 6361, 6362, 6364, 6365, 6367, 6368, 6370, 6371, 6373, 6374, 3942, 3948, 3954, 3938, 3944, 3950, 6375, 6376, 4850, 6377, 4547, 3940, 3946, 3952, 3939, 3945, 3951, 4159, 5479, 4548, 3941, 3947, 3953, 5121, 6378, 6379, 6380, 6381, 4156, 6382, 3937, 3943, 3949, 6383, 6384, 6385, 5194, 4157, 6386, 6387, 6388, 6389, 6390, 6391, 6478, 4968, 4527, 6479, 4298, 6480, 4418, 4419, 5339, 4437, 4438, 4439, 7264, 7265, 7266, 7267, 7268, 7269, 7270, 7271, 7272, 7273, 4462, 6160, 6161, 4123, 3960, 4299, 3966, 4127, 6162, 3962, 3961, 6163, 6164, 3963, 3964, 6165, 3965, 3999, 4000, 6166, 6167, 4155, 6168, 6169, 6170, 4311, 6171, 6159, 6172, 6173, 4672, 4312, 6174, 6175, 4158, 6176, 6177, 6178, 6179, 6492, 6493, 4783, 4121, 4551, 6494, 3955, 3956, 4119, 3957, 3958, 3959, 4848, 6495, 4849, 6496, 6497, 6498, 4396, 4402, 6327, 4398, 4404, 6328, 4397, 4403, 6329, 6331, 4395, 4401, 6332, 6333, 6334, 6335, 4042, 6336, 6337, 6338, 6339, 6340, 6341, 6342, 6392, 6393, 6394, 6396, 6397, 6399, 6400, 6402, 6403, 6405, 6406, 3911, 3917, 3923, 3907, 3913, 3919, 6407, 6408, 5419, 6409, 6410, 3909, 3915, 3921, 3908, 3914, 3920, 6411, 6412, 6413, 3910, 3916, 3922, 6414, 6415, 6416, 6417, 6418, 6419, 6420, 3906, 3912, 3918, 6421, 6422, 6423, 6424, 6425, 6426, 6427, 6428, 6429, 6430, 6431, 6481, 6482, 4302, 6483, 6484, 6485, 4432, 4301, 4862, 4434, 4435, 4436, 7274, 7275, 7276, 7277, 7278, 7279, 7280, 7281, 7282, 7283, 6248, 6249, 6238, 3929, 6241, 3935, 6242, 6250, 3931, 3930, 6251, 6252, 3932, 3933, 6253, 3934, 3998, 3936, 6254, 6255, 6243, 6256, 6257, 6258, 6244, 6259, 4318, 6260, 6261, 6239, 6245, 6262, 6263, 6237, 6264, 6265, 6266, 6267, 6502, 6503, 6504, 6505, 6506, 6507, 3924, 3925, 6508, 3926, 3927, 3928, 6509, 6510, 6511, 6512, 6513, 6514, 4421, 4427, 6344, 4423, 4429, 6345, 4422, 4428, 6346, 6348, 4420, 4426, 6349, 6350, 6351, 6352, 6353, 6354, 6355, 6356, 6357, 6358, 6359, 6360, 6432, 6433, 6434, 6436, 6437, 6439, 6440, 6442, 6443, 6445, 6446, 3972, 3978, 3984, 3968, 3974, 3980, 6453, 6454, 6455, 6456, 6457, 3970, 3976, 3982, 3969, 3975, 3981, 6458, 6459, 6460, 3971, 3977, 3983, 6461, 6462, 6463, 6464, 5145, 6465, 6466, 3967, 3973, 3979, 6467, 6468, 6469, 6470, 6471, 6472, 6473, 6474, 6475, 6476, 6477, 6486, 6487, 6488, 6489, 6147, 6491, 4440, 4441, 6490, 4442, 4443, 4444, 7284, 7285, 7286, 7287, 4463, 7288, 4464, 7289, 7290, 4465, 4466, 7291, 7292, 4467, 7293, 6205, 6206, 6193, 3990, 6197, 3996, 6198, 6207, 3992, 3991, 6208, 6209, 3993, 3994, 6210, 3995, 4001, 3997, 6211, 6212, 6199, 6213, 6214, 6215, 6200, 6216, 6204, 6217, 6218, 6195, 6201, 6219, 6220, 6192, 6221, 6222, 6223, 6224, 6518, 6519, 6520, 6521, 4552, 6522, 3985, 3986, 6523, 3987, 3988, 3989, 6524, 6093, 6525, 6526, 6527, 6528) 
        AND `ativo` = '1' ";
$campos = bancos::sql($sql);
$linhas = count($campos);
for($i = 0; $i < $linhas; $i++) {
    //Verifico se o atual "PI do Loop" existe na Lista de Preos da Winner ...
    $sql = "SELECT id_fornecedor_prod_insumo 
            FROM `fornecedores_x_prod_insumos` 
            WHERE `id_fornecedor` = '2162' 
            AND `id_produto_insumo` = '".$campos[$i]['id_produto_insumo']."' LIMIT 1 ";
    $campos_lista = bancos::sql($sql);
    if(count($campos_lista) == 0) {//Esse item no existe na Lista de Preo da Winner ...
        $sql = "INSERT INTO `fornecedores_x_prod_insumos` (`id_fornecedor_prod_insumo`, `id_fornecedor`, 
                `id_produto_insumo`, `preco`, `preco_exportacao`, `preco_faturado`, `preco_faturado_adicional`, 
                `prazo_pgto_ddl`, `desc_vista`, `desc_sgd`, `ipi`, `icms`, `reducao`, `iva`, `lote_minimo_reais`, 
                `forma_compra`, `tp_moeda`, `preco_faturado_export`, `preco_faturado_export_adicional`, 
                `valor_moeda_compra`, `condicao_padrao`, `fator_margem_lucro_pa`, `valor_moeda_custo`, 
                `data_sys`, `lote_minimo_pa_rev`, `ativo`) 
                VALUES (NULL, '2162', '".$campos[$i]['id_produto_insumo']."', 
                '".$campos[$i]['preco']."', '".$campos[$i]['preco_exportacao']."', 
                '".$campos[$i]['preco_faturado']."', '".$campos[$i]['preco_faturado_adicional']."', 
                '".$campos[$i]['prazo_pgto_ddl']."', '".$campos[$i]['desc_vista']."', 
                '".$campos[$i]['desc_sgd']."', '".$campos[$i]['ipi']."', 
                '".$campos[$i]['icms']."', '".$campos[$i]['reducao']."', 
                '".$campos[$i]['iva']."', '".$campos[$i]['lote_minimo_reais']."', 
                '".$campos[$i]['forma_compra']."', '".$campos[$i]['tp_moeda']."', 
                '".$campos[$i]['preco_faturado_export']."', '".$campos[$i]['preco_faturado_export_adicional']."', 
                '".$campos[$i]['valor_moeda_compra']."', '".$campos[$i]['condicao_padrao']."', 
                '".$campos[$i]['fator_margem_lucro_pa']."', '".$campos[$i]['valor_moeda_custo']."', 
                '".date('Y-m-d H:i:s')."', '".$campos[$i]['lote_minimo_pa_rev']."', '1') ";
    }else {
        $sql = "UPDATE `fornecedores_x_prod_insumos` SET `preco` = '".$campos[$i]['preco']."', 
                `preco_exportacao` = '".$campos[$i]['preco_exportacao']."', 
                `preco_faturado` = '".$campos[$i]['preco_faturado']."', 
                `preco_faturado_adicional` = '".$campos[$i]['preco_faturado_adicional']."', 
                `prazo_pgto_ddl` = '".$campos[$i]['prazo_pgto_ddl']."', 
                `desc_vista` = '".$campos[$i]['desc_vista']."', `desc_sgd` = '".$campos[$i]['desc_sgd']."', 
                `ipi` = '".$campos[$i]['ipi']."', `icms` = '".$campos[$i]['icms']."', 
                `reducao` = '".$campos[$i]['reducao']."', `iva` = '".$campos[$i]['iva']."', 
                `lote_minimo_reais` = '".$campos[$i]['lote_minimo_reais']."', 
                `forma_compra` = '".$campos[$i]['forma_compra']."', 
                `tp_moeda` = '".$campos[$i]['tp_moeda']."', 
                `preco_faturado_export` = '".$campos[$i]['preco_faturado_export']."', 
                `preco_faturado_export_adicional` = '".$campos[$i]['preco_faturado_export_adicional']."', 
                `valor_moeda_compra` = '".$campos[$i]['valor_moeda_compra']."', 
                `condicao_padrao` = '".$campos[$i]['condicao_padrao']."', 
                `fator_margem_lucro_pa` = '".$campos[$i]['fator_margem_lucro_pa']."', 
                `valor_moeda_custo` = '".$campos[$i]['valor_moeda_custo']."', 
                `data_sys` = '".date('Y-m-d H:i:s')."', 
                `lote_minimo_pa_rev` = '".$campos[$i]['lote_minimo_pa_rev']."', `ativo` = '1' 
                WHERE `id_fornecedor` = '2162' AND `id_produto_insumo` = '".$campos[$i]['id_produto_insumo']."' LIMIT 1";
    }
    echo '<br/>'.$sql.';';
    //bancos::sql($sql);
}
?>